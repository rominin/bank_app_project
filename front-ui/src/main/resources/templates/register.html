<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Регистрация</title>
</head>
<body>
<h1>Регистрация</h1>
<form th:action="@{/register}" method="post">
  <label for="username">Логин:</label>
  <input type="text" id="username" name="username" required/><br/>

  <label for="password">Пароль:</label>
  <input type="password" id="password" name="password" required/><br/>

  <label for="firstName">Имя:</label>
  <input type="text" id="firstName" name="firstName" required/><br/>

  <label for="lastName">Фамилия:</label>
  <input type="text" id="lastName" name="lastName" required/><br/>

  <label for="email">Email:</label>
  <input type="email" id="email" name="email" required/><br/>

  <label for="birthDate">Дата рождения:</label>
  <input type="date" id="birthDate" name="birthDate" required/><br/>

  <button type="submit">Зарегистрироваться</button>
</form>


<div th:if="${error}" th:text="${error}" style="color:red"></div>
<div th:if="${success}" th:text="${success}" style="color:green"></div>

<a th:href="@{/login}">Уже есть аккаунт? Войти</a>
</body>
</html>

<div id="ageError" style="color:red; margin-top:10px;"></div>

<script>
  function isAdult(birthDateStr) {
    const today = new Date();
    const birthDate = new Date(birthDateStr);
    const age = today.getFullYear() - birthDate.getFullYear();
    const m = today.getMonth() - birthDate.getMonth();

    return age > 18 || (age === 18 && m >= 0 && today.getDate() >= birthDate.getDate());
  }

  function validateForm(event) {
    const birthDateInput = document.getElementById("birthDate");
    const birthDate = birthDateInput.value;

    const errorDiv = document.getElementById("ageError");
    errorDiv.textContent = "";

    if (!isAdult(birthDate)) {
      event.preventDefault();
      errorDiv.textContent = "Вам должно быть не менее 18 лет.";
    }
  }

  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form");
    form.addEventListener("submit", validateForm);
  });
</script>